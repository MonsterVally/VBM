add_namespace = SEA_japan_popup_events
add_namepsace = SEA_japan

country_event = {
	id = SEA_japan.1
	title = SEA_japan.1.t
	desc = SEA_japan.1.desc
	picture = GFX_report_event_JAP_kodoha_coup_attempt_preparation 
	
	is_triggered_only = yes

	fire_only_once = yes
	
	# We want to go for the historical option :/
	option = { 
		name = SEA_japan.1.a

		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					AND = {
						is_historical_focus_on = yes
						has_game_rule = {
							rule = JAP_ai_behavior
							option = DEFAULT
						}
					}
					has_game_rule = {
						rule = JAP_ai_behavior
						option = FASCIST
					}
					has_country_flag = JAP_AI_RANDOM_FASCIST
				}
			}
		}
		# TRUE NON HIST
		trigger = {
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes           
					has_country_flag = vbm_jap_true_non_hist_fas
				} 
			}
		}
		
		custom_effect_tooltip = JAP_kodoha_coup_will_fail_historically_tt
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_korekiyo_protected_flag
				}
			}
			retire_character = JAP_takahashi_korekiyo
			set_country_flag = JAP_takahashi_korekiyo_was_killed
		}
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_watanabe_protected_flag
				}
			}
			retire_character = JAP_jotaro_watanabe
			set_country_flag = JAP_jotaro_watanabe_was_killed
		}
		IF = {
			limit = {
				has_dlc = "No Compromise, No Surrender"
				OR = {
					has_country_flag = JAP_watanabe_protected_flag
					has_country_flag = JAP_korekiyo_protected_flag
				}
			}
			# Due to one of the other assassinations failing, they will go harder for Saionji Kinmochi instead, killing him. 
			retire_character = JAP_saionji_kinmochi
		}

		custom_effect_tooltip = generic_skip_one_line_tt
		
		complete_national_focus = JAP_sea_purge_the_kodoha_faction

		hidden_effect = {
			set_country_flag = JAP_aizawas_trial_over_flag
		}

	}

	# It's shougunating time heck yea
	option = { 
		name = SEA_japan.1.b

		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					has_country_flag = JAP_AI_RANDOM_NEUTRALITY
					has_game_rule = {
						rule = JAP_ai_behavior
						option = NEUTRALITY
					}
				}
			}
		}
		# TRUE NON HIST
		trigger = {
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes           
					has_country_flag = vbm_jap_true_non_hist_non
				} 
			}
		}
		custom_effect_tooltip = JAP_kodoha_coup_will_succeed_tt
		
		retire_character = JAP_takahashi_korekiyo
		set_country_flag = JAP_takahashi_korekiyo_was_killed
	
		retire_character = JAP_jotaro_watanabe
		set_country_flag = JAP_jotaro_watanabe_was_killed
		
		IF = {
			limit = {
				has_dlc = "No Compromise, No Surrender"
			}
			# Due to one of the other assassinations failing, they will go harder for Saionji Kinmochi instead, killing hnm. 
			retire_character = JAP_saionji_kinmochi
		}

		custom_effect_tooltip = generic_skip_one_line_tt
		
		IF = {
			limit = {
				has_dlc = "No Compromise, No Surrender"
			}
			IF = {
				limit = {
					has_country_leader = {
						ruling_only = yes
						character = JAP_keisuke_okada
					}	
				}
				kill_country_leader = yes
			}
			add_country_leader_role = {
				character =  JAP_jinzaburo_masaki
				promote_leader = yes
				country_leader = {
					ideology = japan_militarism_ideology
					expire = "1952.1.1.1"
					traits = { JAP_military_prime_minister } 
				}
			}

			custom_effect_tooltip = generic_skip_one_line_tt
			
			complete_national_focus = JAP_revere_the_emperor_destroy_the_traitors
			#custom_effect_tooltip = focus_effects_are_as_follows_tt
			#effect_tooltip = {
			#	
			#}
		}
		ELSE = {
			complete_national_focus = JAP_support_the_kodoha_faction
		}

		hidden_effect = {
			set_country_flag = JAP_aizawas_trial_over_flag
		}

	}

	# We have come to the conclusion that fascism = bad
	option = { 
		name = SEA_japan.1.c
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					has_country_flag = JAP_AI_RANDOM_COMMUNIST
					has_game_rule = {
						rule = JAP_ai_behavior
						option = COMMUNIST
					}
					has_country_flag = JAP_AI_RANDOM_DEMOCRATIC
					has_game_rule = {
						rule = JAP_ai_behavior
						option = DEMOCRATIC
					}
					has_country_flag = JAP_AI_RANDOM_COMMUNIST_2
					has_game_rule = {
						rule = JAP_ai_behavior
						option = COMMUNIST_2
					}
				}
			}
		}
		# TRUE NON HIST
		trigger = {
			has_dlc = "No Compromise, No Surrender"
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes
					OR = {
						has_country_flag = vbm_jap_true_non_hist_com
						has_country_flag = vbm_jap_true_non_hist_dem
					}           
					
				} 
			}
		}

		custom_effect_tooltip = JAP_kodoha_coup_will_fail_non_historically_tt
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_korekiyo_protected_flag
				}
			}
			retire_character = JAP_takahashi_korekiyo
			set_country_flag = JAP_takahashi_korekiyo_was_killed
		}
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_watanabe_protected_flag
				}
			}
			retire_character = JAP_jotaro_watanabe
			set_country_flag = JAP_jotaro_watanabe_was_killed
		}
		IF = {
			limit = {
				OR = {
					has_country_flag = JAP_watanabe_protected_flag
					has_country_flag = JAP_korekiyo_protected_flag
				}
			}
			# Due to one of the other assassinations failing, they will go harder for Saionji Kinmochi instead, killing hnm. remove Kinmochi etc
			retire_character = JAP_saionji_kinmochi
		}

		custom_effect_tooltip = generic_skip_one_line_tt

		add_country_leader_role = {
			character = JAP_keisuke_okada
			promote_leader = yes
			country_leader = {
				ideology = conservatism
				expire = "1952.1.1.1"
				traits = { JAP_moderate_politician_dem } 
			}
		}	

		set_politics = {
			ruling_party = democratic
			elections_allowed = yes
			last_election = "1936.02.01"
			election_frequency = 48
		}	

		add_popularity = {
			ideology = democratic
			popularity = 0.15
		}	

		custom_effect_tooltip = generic_skip_one_line_tt
		
		complete_national_focus = JAP_okadas_military_purge_speech
		custom_effect_tooltip = focus_effects_are_as_follows_tt
		effect_tooltip = {
			JAP_small_government_faction_gain = yes

			custom_effect_tooltip = generic_skip_one_line_tt

			custom_effect_tooltip = JAP_okadas_military_purge_speech_tt
		}

		hidden_effect = {
			set_country_flag = JAP_aizawas_trial_over_flag
		}

	}

	# We have come to the conclusion that fascism = bad (non sea dem)
	option = { 
		name = SEA_japan.1.d
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					has_country_flag = JAP_AI_RANDOM_DEMOCRATIC
					has_game_rule = {
						rule = JAP_ai_behavior
						option = DEMOCRATIC
					}
				}
			}
		}
		trigger = {
			NOT = {
				has_dlc = "No Compromise, No Surrender"
			}
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes
					OR = {
						has_country_flag = vbm_jap_true_non_hist_dem
					}           
					
				} 
			}
		}

		custom_effect_tooltip = JAP_kodoha_coup_will_fail_non_historically_tt
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_korekiyo_protected_flag
				}
			}
			retire_character = JAP_takahashi_korekiyo
			set_country_flag = JAP_takahashi_korekiyo_was_killed
		}
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_watanabe_protected_flag
				}
			}
			retire_character = JAP_jotaro_watanabe
			set_country_flag = JAP_jotaro_watanabe_was_killed
		}

		custom_effect_tooltip = generic_skip_one_line_tt
		
		complete_national_focus = JAP_strengthen_civilian_government

		hidden_effect = {
			set_country_flag = JAP_aizawas_trial_over_flag
		}

	}

	# We have come to the conclusion that fascism = bad (non sea com)
	option = { 
		name = SEA_japan.1.e
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					has_country_flag = JAP_AI_RANDOM_COMMUNIST
					has_game_rule = {
						rule = JAP_ai_behavior
						option = COMMUNIST
					}
				}
			}
		}
		trigger = {
			NOT = {
				has_dlc = "No Compromise, No Surrender"
			}
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes
					OR = {
						has_country_flag = vbm_jap_true_non_hist_com
					}           
					
				} 
			}
		}

		custom_effect_tooltip = JAP_kodoha_coup_will_fail_non_historically_tt
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_korekiyo_protected_flag
				}
			}
			retire_character = JAP_takahashi_korekiyo
			set_country_flag = JAP_takahashi_korekiyo_was_killed
		}
		IF = {
			limit = {
				NOT = {
					has_country_flag = JAP_watanabe_protected_flag
				}
			}
			retire_character = JAP_jotaro_watanabe
			set_country_flag = JAP_jotaro_watanabe_was_killed
		}

		custom_effect_tooltip = generic_skip_one_line_tt
		
		complete_national_focus = JAP_the_unthinkable_option

		hidden_effect = {
			set_country_flag = JAP_aizawas_trial_over_flag
		}

	}

}
country_event = {
	id = SEA_japan_popup_events.16
	title = SEA_japan_popup_events.16.t
	desc = SEA_japan_popup_events.16.desc
	picture = GFX_report_event_japanese_army_parade
	
	is_triggered_only = yes

	fire_only_once = yes

	# The Liberal Machida Chūji
	option = {
		name = SEA_japan_popup_events.16.a
		ai_chance = {
			base = 50 
			modifier = {
				factor = 0 
				OR = {
					has_country_flag = JAP_AI_RANDOM_COMMUNIST
					has_game_rule = {
						rule = JAP_ai_behavior
						option = COMMUNIST
					}
					has_country_flag = JAP_AI_RANDOM_COMMUNIST_2
					has_game_rule = {
						rule = JAP_ai_behavior
						option = COMMUNIST_2
					}
				}
			}
		}
		# TRUE NON HIST
		trigger = {
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes
					OR = {
						has_country_flag = vbm_jap_true_non_hist_dem
					}           
				} 
			}
		}
		IF = {
			limit = {
				NOT = {
					has_country_leader = {
						ruling_only = yes
						character = JAP_machida_chuuji
					}	
				}
			}
			add_country_leader_role = {
				character = JAP_machida_chuuji
				promote_leader = yes
				country_leader = {
					ideology = liberalism
					expire = "1989.1.1.1"
					traits = { HUN_popular_liberal } 
				}
			}
			set_party_name = {
				ideology = democratic
				long_name = JAP_unity_cabinet_party_long
				name = JAP_unity_cabinet_party
			}	
		}
		ELSE = {
			add_popularity = {
				ideology = democratic
				popularity = 0.05
			}	
			add_political_power = 75
			set_party_name = {
				ideology = democratic
				long_name = JAP_unity_cabinet_party_long
				name = JAP_unity_cabinet_party
			}
		}

		custom_effect_tooltip = generic_skip_one_line_tt

		country_event = {
			id = SEA_japan_popup_events.17
			days = 7
		}

	}

	# The Socialist Abe Isoo
	option = {
		name = SEA_japan_popup_events.16.b
		ai_chance = {
			base = 30 
			modifier = {
				factor = 0
				OR = {
					has_country_flag = JAP_AI_RANDOM_DEMOCRATIC
					has_game_rule = {
						rule = JAP_ai_behavior
						option = DEMOCRATIC
					}
				}
			}
		}
		trigger = {
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes
					OR = {
						has_country_flag = vbm_jap_true_non_hist_com
					}           
				} 
			}
		}
		
		add_country_leader_role = {
			character = JAP_abe_isoo
			promote_leader = yes
			country_leader = {
				ideology = socialism
				expire = "1989.1.1.1"
				traits = { JAP_socialist_politician } 
			}
		}
		set_party_name = {
			ideology = democratic
			long_name = JAP_unity_cabinet_party_long
			name = JAP_unity_cabinet_party
		}

		custom_effect_tooltip = generic_skip_one_line_tt

		country_event = {
			id = SEA_japan_popup_events.17
			days = 7
		}

	}

	# President of the House of Peers, Tokugawa Iesato
	option = {
		name = SEA_japan_popup_events.16.c
		ai_chance = {
			base = 20 
			modifier = {
				factor = 0 
				OR = {
					has_country_flag = JAP_AI_RANDOM_COMMUNIST
					has_game_rule = {
						rule = JAP_ai_behavior
						option = COMMUNIST
					}
					has_country_flag = JAP_AI_RANDOM_COMMUNIST_2
					has_game_rule = {
						rule = JAP_ai_behavior
						option = COMMUNIST_2
					}
				}
			}
		}
		trigger = {
			OR = {
				NOT = { vbm_true_non_hist_on = yes }   # rule off → idc
				AND = {
					vbm_true_non_hist_on = yes
					OR = {
						has_country_flag = vbm_jap_true_non_hist_dem
					}           
				} 
			}
		}
		add_country_leader_role = {
			character = JAP_tokugawa_iesato
			promote_leader = yes
			country_leader = {
				ideology = conservatism
				expire = "1989.1.1.1"
				traits = { JAP_popular_diplomat } 
			}
		}
		set_party_name = {
			ideology = democratic
			long_name = JAP_unity_cabinet_party_long
			name = JAP_unity_cabinet_party
		}

		custom_effect_tooltip = generic_skip_one_line_tt

		country_event = {
			id = SEA_japan_popup_events.17
			days = 7
		}

	}

}